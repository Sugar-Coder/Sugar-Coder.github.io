# ç”»é¥¼
æœ€è¿‘è¦æŠŠå®éªŒç»“æœæå¾—å¥½çœ‹ä¸€ç‚¹ï¼Œå‡†å¤‡ç”»ä¸ªé¥¼å›¾ã€‚

æ‰¾matplotlibçš„galleryæ‰¾åˆ°äº†ä¸€ä¸ªåŒå¿ƒé¥¼å›¾ï¼Œå‡†å¤‡åœ¨å†…åœˆä¸­æ¯éš”ä¸€ä¸ªè‰²å—åŠ ä¸€ä¸ªlabelï¼Œçœ‹[matplotlib.axes.Axes.pie](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.pie.html#matplotlib.axes.Axes.pie)çš„å®˜æ–¹æ–‡æ¡£å‘ç°æœ‰ä¸ªautopctçš„å‚æ•°ï¼Œä¸€èˆ¬ç”¨æ¥è®¾ç½®é¥¼å›¾ä¸­æ¯ä¸ªæ‰‡å½¢çš„åœˆä¸Šæ–‡å­—æ ‡ç­¾ï¼Œä½†è¿™ä¸ªautopctä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºè¾“å…¥ã€‚

åœ¨[stackoverflow](https://stackoverflow.com/questions/6170246/how-do-i-use-matplotlib-autopct/6170354#6170354)ä¸Šæ‰¾åˆ°äº†ç”¨æ³•ã€‚éœ€è¦è‡ªå·±å®šä¹‰ä¸€ä¸ªè¿”å›å‡½æ•°çš„å‡½æ•°ï¼Œæ¥ä¸ªæ€§åŒ–è¿™ä¸ªautopctçš„è¾“å‡ºã€‚

ä½¿ç”¨pythoné—­åŒ…çš„ç‰¹æ€§ï¼Œåœ¨å¤–å±‚å‡½æ•°ä¸­å®šä¹‰è®°å½•å¸ƒå°”å˜é‡shouldPrintï¼Œè®°å½•ä¸Šä¸ªæ‰‡å½¢æ˜¯å¦è¢«æ ‡è®°ã€‚
```python
def make_autopct(values):
    shouldPrint = False

    def my_autopct(pct):
        nonlocal shouldPrint
        total = sum(values)
        val = int(round(pct*total/100.0))
        if shouldPrint:
            shouldPrint = False
            if val != 0:
                return '{p:.2f}% ({v:d})'.format(p=pct, v=val)
            else:
                return ''
        else:
            shouldPrint = True
            return ''
    return my_autopct
```
å†å°†è¿™ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ä¼ ç»™autopctï¼Œå‚æ•°æ˜¯å¹³æ•´åçš„valsä¸€ä½æ•°ç»„
```python
def plotPie():
    vals = np.array([[30, 60], [20, 40], [55, 43], [22, 0]])
    fig, ax = plt.subplots()

    size = 0.3

    cmap = plt.get_cmap("tab20c")
    outer_colors = cmap(np.arange(4) * 4)
    inner_colors = cmap([1, 2, 5, 6, 9, 10, 13, 14])

    ax.pie(vals.sum(axis=1), radius=1, colors=outer_colors, labels=outer_labels,
           wedgeprops=dict(width=size, edgecolor='w'))

    ax.pie(vals.flatten(), radius=1 - size, colors=inner_colors, autopct=make_autopct(vals.flatten()),
           wedgeprops=dict(width=size, edgecolor='w'))

    ax.set(aspect="equal", title='The Pie')
    plt.show()
```
ğŸ«“å¦‚ä¸‹

![](./images/blog20220517/out.jpg)
